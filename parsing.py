import requests
import json
import time
import random
from datetime import datetime
from concurrent.futures import ThreadPoolExecutor, as_completed

API_KEY = "7986de53-5751-49b3-8ba5-52e0a8f575c0"


def enhanced_convert_2gis_to_target_format(place_data):
    """–£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ 2–ì–ò–°"""

    converted_place = {
        "title": "",
        "url": "",
        "description": "",
        "entity_types": [],
        "atmosphere_tags": [],
        "purpose_tags": [],
        "budget_level": "",
        "features": [],
        "best_time": "",
        "opening_hours": "",
        "working_days": [],
        "is_24_7": False,
        "overall_rating": 0.0,
        "photo": "",
        "created_at": datetime.now().isoformat(),
    }

    if "name" in place_data:
        converted_place["title"] = place_data["name"]

    if "external_content" in place_data:
        converted_place["url"] = place_data["external_content"].get("url", "")

    if "description" in place_data and place_data["description"]:
        converted_place["description"] = place_data["description"]

    # –ú–ê–ü–ü–ò–ù–ì –¢–ò–ü–û–í
    if "rubrics" in place_data:
        for rubric in place_data["rubrics"]:
            rubric_name = rubric.get("name", "").lower()

            rubric_mapping = {
                "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "–∫–∞—Ñ–µ": "–∫–∞—Ñ–µ",
                "–±–∞—Ä": "–±–∞—Ä",
                "–ø–∞–±": "–±–∞—Ä",
                "–∫–æ—Ñ–µ–π–Ω—è": "–∫–æ—Ñ–µ–π–Ω—è",
                "—á–∞–π–Ω–∞—è": "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫",
                "—Å—Ç–æ–ª–æ–≤–∞—è": "–∫–∞—Ñ–µ",
                "–±–∏—Å—Ç—Ä–æ": "–∫–∞—Ñ–µ",
                "–ø–∏—Ü—Ü–µ—Ä–∏—è": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "—Å—É—à–∏": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "–±—É—Ä–≥–µ—Ä–Ω–∞—è": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "—à–∞—à–ª—ã—á–Ω–∞—è": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "–±–ª–∏–Ω–Ω–∞—è": "–∫–∞—Ñ–µ",
                "–ø–µ–ª—å–º–µ–Ω–Ω–∞—è": "–∫–∞—Ñ–µ",
                "–≥—Ä–∏–ª—å-–±–∞—Ä": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "—Ç—Ä–∞–∫—Ç–∏—Ä": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
                "–≤–∏–Ω–Ω—ã–π –±–∞—Ä": "–±–∞—Ä",
                "–ø–∏–≤–Ω–æ–π": "–±–∞—Ä",
                "–ª–∞—É–Ω–∂-–±–∞—Ä": "–±–∞—Ä",
                "—Å–ø–æ—Ä—Ç-–±–∞—Ä": "–±–∞—Ä",
                "–∫–∞—Ä–∞–æ–∫–µ-–±–∞—Ä": "–±–∞—Ä",
                "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è": "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è",
                "–ø–µ–∫–∞—Ä–Ω—è": "–ø–µ–∫–∞—Ä–Ω—è",
                "–º–æ—Ä–æ–∂–µ–Ω–æ–µ": "–∫–∞—Ñ–µ",
                "—à–æ–∫–æ–ª–∞–¥": "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è",
                "–º—É–∑–µ–π": "–º—É–∑–µ–π",
                "–≥–∞–ª–µ—Ä–µ—è": "–≥–∞–ª–µ—Ä–µ—è",
                "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä": "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä",
                "—Ç–µ–∞—Ç—Ä": "—Ç–µ–∞—Ç—Ä",
                "–∫–ª—É–±": "–∫–ª—É–±",
                "–Ω–æ—á–Ω–æ–π –∫–ª—É–±": "–∫–ª—É–±",
                "–±–∏–ª—å—è—Ä–¥": "–∫–ª—É–±",
                "–±–æ—É–ª–∏–Ω–≥": "–∫–ª—É–±",
                "–∞–Ω—Ç–∏–∫–∞—Ñ–µ": "–∞–Ω—Ç–∏–∫–∞—Ñ–µ",
                "–ø–∞—Ä–∫": "–ø–∞—Ä–∫",
                "—Å–∫–≤–µ—Ä": "–ø–∞—Ä–∫",
                "—Å–∞–¥": "–ø–∞—Ä–∫",
                "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è": "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è",
                "–ø–ª–æ—â–∞–¥—å": "–ø–ª–æ—â–∞–¥—å",
                "—Å–º–æ—Ç—Ä–æ–≤–∞—è": "—Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞",
                "–±—É—Ç–∏–∫": "–±—É—Ç–∏–∫",
                "–º–∞–≥–∞–∑–∏–Ω": "–±—É—Ç–∏–∫",
                "—Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä": "–±—É—Ç–∏–∫",
                "—Å—É–≤–µ–Ω–∏—Ä": "—Å—É–≤–µ–Ω–∏—Ä–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω",
                "–≤–∏–Ω—Ç–∞–∂–Ω—ã–π": "–≤–∏–Ω—Ç–∞–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω",
                "–∫–Ω–∏–∂–Ω—ã–π": "–∫–Ω–∏–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω",
                "–æ—Ç–µ–ª—å": "–æ—Ç–µ–ª—å",
                "–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞": "–æ—Ç–µ–ª—å",
                "—Ö–æ—Å—Ç–µ–ª": "–æ—Ç–µ–ª—å",
                "—Å–∞—É–Ω–∞": "—Å—Ç—É–¥–∏—è",
                "—Å–ø–∞": "—Å—Ç—É–¥–∏—è",
                "–±–∞–Ω—è": "—Å—Ç—É–¥–∏—è",
                "—Ñ–∏—Ç–Ω–µ—Å": "—Å—Ç—É–¥–∏—è",
                "–π–æ–≥–∞": "—Å—Ç—É–¥–∏—è",
                "—Ö—Ä–∞–º": "—Ö—Ä–∞–º",
                "—Å–æ–±–æ—Ä": "–∫–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω—ã–π —Å–æ–±–æ—Ä",
                "—Ü–µ—Ä–∫–æ–≤—å": "—Ö—Ä–∞–º",
                "–ø–∞–º—è—Ç–Ω–∏–∫": "–ø–∞–º—è—Ç–Ω–∏–∫",
                "—Ñ–æ–Ω—Ç–∞–Ω": "—Å–∫—É–ª—å–ø—Ç—É—Ä–∞",
            }

            for key, value in rubric_mapping.items():
                if key in rubric_name:
                    if value not in converted_place["entity_types"]:
                        converted_place["entity_types"].append(value)

    # –ï—Å–ª–∏ —Ç–∏–ø—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
    if not converted_place["entity_types"] and converted_place["title"]:
        title_lower = converted_place["title"].lower()
        title_mapping = {
            "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
            "–∫–∞—Ñ–µ": "–∫–∞—Ñ–µ",
            "–±–∞—Ä": "–±–∞—Ä",
            "–ø–∞–±": "–±–∞—Ä",
            "–∫–æ—Ñ–µ–π–Ω—è": "–∫–æ—Ñ–µ–π–Ω—è",
            "–∫–æ—Ñ–µ": "–∫–æ—Ñ–µ–π–Ω—è",
            "—á–∞–π": "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫",
            "–º—É–∑–µ–π": "–º—É–∑–µ–π",
            "–≥–∞–ª–µ—Ä–µ—è": "–≥–∞–ª–µ—Ä–µ—è",
            "–∫–∏–Ω–æ": "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä",
            "—Ç–µ–∞—Ç—Ä": "—Ç–µ–∞—Ç—Ä",
            "–∫–ª—É–±": "–∫–ª—É–±",
            "–æ—Ç–µ–ª—å": "–æ—Ç–µ–ª—å",
            "–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞": "–æ—Ç–µ–ª—å",
            "–±—É—Ç–∏–∫": "–±—É—Ç–∏–∫",
            "–º–∞–≥–∞–∑–∏–Ω": "–±—É—Ç–∏–∫",
            "—Å–∞–ª–æ–Ω": "–±—É—Ç–∏–∫",
            "—Å–ø–æ—Ä—Ç": "—Å—Ç—É–¥–∏—è",
            "—Ñ–∏—Ç–Ω–µ—Å": "—Å—Ç—É–¥–∏—è",
            "–π–æ–≥–∞": "—Å—Ç—É–¥–∏—è",
            "—Ö—Ä–∞–º": "—Ö—Ä–∞–º",
            "—Å–æ–±–æ—Ä": "–∫–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω—ã–π —Å–æ–±–æ—Ä",
            "—Ü–µ—Ä–∫–æ–≤—å": "—Ö—Ä–∞–º",
            "–ø–∞–º—è—Ç–Ω–∏–∫": "–ø–∞–º—è—Ç–Ω–∏–∫",
            "–ø–∞—Ä–∫": "–ø–∞—Ä–∫",
            "—Å–∫–≤–µ—Ä": "–ø–∞—Ä–∫",
            "—Å–∞–¥": "–ø–∞—Ä–∫",
            "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è": "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è",
            "–ø–ª–æ—â–∞–¥—å": "–ø–ª–æ—â–∞–¥—å",
        }

        for key, value in title_mapping.items():
            if key in title_lower:
                converted_place["entity_types"].append(value)
                break

    if not converted_place["entity_types"]:
        converted_place["entity_types"] = ["–∫–∞—Ñ–µ"]

    # –ê–¢–ú–û–°–§–ï–†–ê
    atmosphere_by_type = {
        "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": ["—ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π", "–ø—Ä–µ–º–∏—É–º", "—Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π"],
        "–∫–∞—Ñ–µ": ["—É—é—Ç–Ω—ã–π", "–¥–æ–º–∞—à–Ω–∏–π", "–Ω–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω–Ω—ã–π"],
        "–±–∞—Ä": ["—ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π", "—à—É–º–Ω—ã–π", "–≤–µ—á–µ—Ä–Ω–∏–π", "–¥—Ä—É–∂–µ—Å–∫–∏–π"],
        "–∫–æ—Ñ–µ–π–Ω—è": ["—É—é—Ç–Ω—ã–π", "—Ç–∏—Ö–∏–π", "–¥–Ω–µ–≤–Ω–æ–π", "—Ä–∞–±–æ—á–∏–π"],
        "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫": ["—Å–ø–æ–∫–æ–π–Ω—ã–π", "—É—é—Ç–Ω—ã–π", "–¥–Ω–µ–≤–Ω–æ–π", "–º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω—ã–π"],
        "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è": ["—É—é—Ç–Ω—ã–π", "—Å–ª–∞–¥–∫–∏–π", "–¥–Ω–µ–≤–Ω–æ–π", "—Å–µ–º–µ–π–Ω—ã–π"],
        "–ø–µ–∫–∞—Ä–Ω—è": ["—É—é—Ç–Ω—ã–π", "–¥–æ–º–∞—à–Ω–∏–π", "–¥–Ω–µ–≤–Ω–æ–π", "–∞—Ä–æ–º–∞—Ç–Ω—ã–π"],
        "–º—É–∑–µ–π": ["—Å–ø–æ–∫–æ–π–Ω—ã–π", "—Ç–∏—Ö–∏–π", "–∫—É–ª—å—Ç—É—Ä–Ω—ã–π", "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π"],
        "–≥–∞–ª–µ—Ä–µ—è": ["–±–æ–≥–µ–º–Ω—ã–π", "–∞—Ä—Ç—Ö–∞—É—Å–Ω—ã–π", "—Ç–∏—Ö–∏–π", "–≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π"],
        "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä": ["–ø–æ–ø—É–ª—è—Ä–Ω—ã–π", "–≤–µ—á–µ—Ä–Ω–∏–π", "—Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π"],
        "—Ç–µ–∞—Ç—Ä": ["—ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π", "–∫—É–ª—å—Ç—É—Ä–Ω—ã–π", "–≤–µ—á–µ—Ä–Ω–∏–π", "—Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π"],
        "–∫–ª—É–±": ["—ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π", "—à—É–º–Ω—ã–π", "–Ω–æ—á–Ω–æ–π", "–º–æ–ª–æ–¥–µ–∂–Ω—ã–π"],
        "–ø–∞—Ä–∫": ["—Å–ø–æ–∫–æ–π–Ω—ã–π", "–¥–Ω–µ–≤–Ω–æ–π", "—Å–µ–º–µ–π–Ω—ã–π", "–ø—Ä–∏—Ä–æ–¥–Ω—ã–π"],
        "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è": ["—Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π", "—Å–ø–æ–∫–æ–π–Ω—ã–π", "–≤–µ—á–µ—Ä–Ω–∏–π", "–∂–∏–≤–æ–ø–∏—Å–Ω—ã–π"],
        "–±—É—Ç–∏–∫": ["—ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π", "–ø—Ä–µ–º–∏—É–º", "—Å—Ç–∏–ª—å–Ω—ã–π"],
        "–æ—Ç–µ–ª—å": ["—ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π", "–ø—Ä–µ–º–∏—É–º", "–∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π"],
        "—Ö—Ä–∞–º": ["—Å–ø–æ–∫–æ–π–Ω—ã–π", "–¥—É—Ö–æ–≤–Ω—ã–π", "—Ç–∏—Ö–∏–π", "–≤–æ–∑–≤—ã—à–µ–Ω–Ω—ã–π"],
    }

    for entity_type in converted_place["entity_types"]:
        if entity_type in atmosphere_by_type:
            converted_place["atmosphere_tags"].extend(atmosphere_by_type[entity_type])

    converted_place["atmosphere_tags"] = list(set(converted_place["atmosphere_tags"]))[
        :4
    ]

    # –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï
    purpose_by_type = {
        "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": ["—É–∂–∏–Ω", "—Å–≤–∏–¥–∞–Ω–∏–µ", "–±–∏–∑–Ω–µ—Å", "–ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ", "–¥–µ–ª–æ–≤–æ–π –æ–±–µ–¥"],
        "–∫–∞—Ñ–µ": ["–æ–±–µ–¥", "–¥—Ä—É–∑—å—è", "—Ä–∞–±–æ—Ç–∞", "–±—ã—Å—Ç—Ä—ã–π –≤–∏–∑–∏—Ç", "–ø–µ—Ä–µ–∫—É—Å"],
        "–±–∞—Ä": ["–¥—Ä—É–∑—å—è", "–≤–µ—á–µ—Ä–∏–Ω–∫–∞", "–∞–ª–∫–æ–≥–æ–ª—å", "–∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞", "—Ä–µ–ª–∞–∫—Å"],
        "–∫–æ—Ñ–µ–π–Ω—è": ["—Ä–∞–±–æ—Ç–∞", "—É—á–µ–±–∞", "–≤—Å—Ç—Ä–µ—á–∞", "–Ω–∞–µ–¥–∏–Ω–µ", "—á—Ç–µ–Ω–∏–µ"],
        "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫": ["–≤—Å—Ç—Ä–µ—á–∞", "–Ω–∞–µ–¥–∏–Ω–µ", "—Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è", "–±–µ—Å–µ–¥–∞"],
        "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è": ["–¥–µ—Å–µ—Ä—Ç", "–ø–µ—Ä–µ–∫—É—Å", "–ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ", "—Å–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ä—ã–≤"],
        "–ø–µ–∫–∞—Ä–Ω—è": ["–∑–∞–≤—Ç—Ä–∞–∫", "–ø–µ—Ä–µ–∫—É—Å", "–±—ã—Å—Ç—Ä—ã–π –≤–∏–∑–∏—Ç", "–∫–æ—Ñ–µ —Å –≤—ã–ø–µ—á–∫–æ–π"],
        "–º—É–∑–µ–π": [
            "–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π",
            "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
            "–∫—É–ª—å—Ç—É—Ä–∞",
            "—ç–∫—Å–∫—É—Ä—Å–∏—è",
        ],
        "–≥–∞–ª–µ—Ä–µ—è": [
            "–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π",
            "–∫—É–ª—å—Ç—É—Ä–∞",
            "—Ñ–æ—Ç–æ—Å—ä–µ–º–∫–∞",
            "–≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ",
        ],
        "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä": ["—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", "—Å–≤–∏–¥–∞–Ω–∏–µ", "–¥—Ä—É–∑—å—è", "–æ—Ç–¥—ã—Ö"],
        "—Ç–µ–∞—Ç—Ä": ["–∫—É–ª—å—Ç—É—Ä–∞", "—Å–≤–∏–¥–∞–Ω–∏–µ", "—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", "–∏—Å–∫—É—Å—Å—Ç–≤–æ"],
        "–∫–ª—É–±": ["—Ç–∞–Ω—Ü—ã", "–≤–µ—á–µ—Ä–∏–Ω–∫–∞", "–∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞", "–æ—Ç–¥—ã—Ö"],
        "–ø–∞—Ä–∫": ["–ø—Ä–æ–≥—É–ª–∫–∏", "–æ—Ç–¥—ã—Ö", "—Å–ø–æ—Ä—Ç", "—Å–µ–º—å—è", "–ø–∏–∫–Ω–∏–∫"],
        "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è": ["–ø—Ä–æ–≥—É–ª–∫–∏", "—Å–≤–∏–¥–∞–Ω–∏–µ", "—Ñ–æ—Ç–æ—Å—ä–µ–º–∫–∞", "–º–µ–¥–∏—Ç–∞—Ü–∏—è"],
        "–±—É—Ç–∏–∫": ["—à–æ–ø–ø–∏–Ω–≥", "–ø–æ–¥–∞—Ä–∫–∏", "–º–æ–¥–∞", "–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–∞—Ä–¥–µ—Ä–æ–±–∞"],
        "–æ—Ç–µ–ª—å": ["–æ—Ç–¥—ã—Ö", "–±–∏–∑–Ω–µ—Å", "–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è", "–Ω–æ—á–µ–≤–∫–∞"],
    }

    for entity_type in converted_place["entity_types"]:
        if entity_type in purpose_by_type:
            converted_place["purpose_tags"].extend(purpose_by_type[entity_type])

    converted_place["purpose_tags"] = list(set(converted_place["purpose_tags"]))[:5]

    # –ë–Æ–î–ñ–ï–¢
    budget_by_type = {
        "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": "—Å—Ä–µ–¥–Ω–∏–π",
        "–∫–∞—Ñ–µ": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–±–∞—Ä": "—Å—Ä–µ–¥–Ω–∏–π",
        "–∫–æ—Ñ–µ–π–Ω—è": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫": "—Å—Ä–µ–¥–Ω–∏–π",
        "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è": "—Å—Ä–µ–¥–Ω–∏–π",
        "–ø–µ–∫–∞—Ä–Ω—è": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–º—É–∑–µ–π": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–≥–∞–ª–µ—Ä–µ—è": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä": "—Å—Ä–µ–¥–Ω–∏–π",
        "—Ç–µ–∞—Ç—Ä": "—Å—Ä–µ–¥–Ω–∏–π",
        "–∫–ª—É–±": "–¥–æ—Ä–æ–≥–æ–π",
        "–ø–∞—Ä–∫": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
        "–±—É—Ç–∏–∫": "–¥–æ—Ä–æ–≥–æ–π",
        "–æ—Ç–µ–ª—å": "–¥–æ—Ä–æ–≥–æ–π",
        "—Ö—Ä–∞–º": "–±—é–¥–∂–µ—Ç–Ω—ã–π",
    }

    for entity_type in converted_place["entity_types"]:
        if entity_type in budget_by_type:
            converted_place["budget_level"] = budget_by_type[entity_type]
            break

    # –û–°–û–ë–ï–ù–ù–û–°–¢–ò
    features_by_type = {
        "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": ["–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", "–∞–ª–∫–æ–≥–æ–ª—å", "–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü", "–∂–∏–≤–∞—è –º—É–∑—ã–∫–∞"],
        "–∫–∞—Ñ–µ": ["Wi-Fi", "–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü", "–µ–¥–∞ –Ω–∞ –≤—ã–Ω–æ—Å", "–¥–æ—Å—Ç—É–ø–Ω–∞—è —Å—Ä–µ–¥–∞"],
        "–±–∞—Ä": ["–∞–ª–∫–æ–≥–æ–ª—å", "–∂–∏–≤–∞—è –º—É–∑—ã–∫–∞", "—Ç–∞–Ω—Ü—ã", "–∫–∞—Ä–∞–æ–∫–µ"],
        "–∫–æ—Ñ–µ–π–Ω—è": ["Wi-Fi", "–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω–µ—Ü", "—Ä–∞–±–æ—Ç–∞", "–∫–Ω–∏–≥–∏"],
        "—á–∞–π–Ω—ã–π –¥–æ–º–∏–∫": ["—á–∞–π–Ω–∞—è —Ü–µ—Ä–µ–º–æ–Ω–∏—è", "–≤–æ—Å—Ç–æ—á–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞", "—Ä–µ–ª–∞–∫—Å"],
        "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è": ["—Å–≤–µ–∂–∞—è –≤—ã–ø–µ—á–∫–∞", "–∞–≤—Ç–æ—Ä—Å–∫–∏–µ –¥–µ—Å–µ—Ä—Ç—ã", "–ø–æ–¥–∞—Ä–∫–∏"],
        "–ø–µ–∫–∞—Ä–Ω—è": ["—Å–≤–µ–∂–∏–π —Ö–ª–µ–±", "–≤—ã–ø–µ—á–∫–∞", "–∫–æ—Ñ–µ", "–±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∫—É—Å"],
        "–º—É–∑–µ–π": ["—ç–∫—Å–∫—É—Ä—Å–∏–∏", "–∫—É–ª—å—Ç—É—Ä–∞", "–∏—Å—Ç–æ—Ä–∏—è", "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã"],
        "–ø–∞—Ä–∫": ["–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –≤—Ö–æ–¥", "–ø—Ä–æ–≥—É–ª–∫–∏", "–ø—Ä–∏—Ä–æ–¥–∞", "–¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏"],
    }

    for entity_type in converted_place["entity_types"]:
        if entity_type in features_by_type:
            converted_place["features"].extend(features_by_type[entity_type])

    converted_place["features"] = list(set(converted_place["features"]))[:4]

    # –û–ø–∏—Å–∞–Ω–∏–µ
    if not converted_place["description"]:
        entity_names = ", ".join(converted_place["entity_types"])
        atmosphere_names = ", ".join(converted_place["atmosphere_tags"][:2])
        converted_place["description"] = (
            f"{converted_place['title']} - {entity_names} —Å {atmosphere_names} –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π –≤ —Å–∞–º–æ–º —Å–µ—Ä–¥—Ü–µ –ú–æ—Å–∫–≤—ã"
        )

    # –†–µ–π—Ç–∏–Ω–≥
    if "reviews" in place_data and "rating" in place_data["reviews"]:
        converted_place["overall_rating"] = float(place_data["reviews"]["rating"])
    else:
        default_ratings = {
            "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": 4.5,
            "–∫–∞—Ñ–µ": 4.3,
            "–±–∞—Ä": 4.2,
            "–∫–æ—Ñ–µ–π–Ω—è": 4.6,
            "–º—É–∑–µ–π": 4.7,
            "–ø–∞—Ä–∫": 4.8,
            "–æ—Ç–µ–ª—å": 4.4,
        }
        for entity_type in converted_place["entity_types"]:
            if entity_type in default_ratings:
                converted_place["overall_rating"] = default_ratings[entity_type]
                break

    return converted_place


def search_2gis_aggressive(category, city="–º–æ—Å–∫–≤–∞", page_size=50, page=1):
    """–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""

    url = "https://catalog.api.2gis.ru/3.0/items"
    params = {
        "q": category,
        "region": city,
        "key": API_KEY,
        "page_size": page_size,
        "page": page,
        "fields": "items.name,items.rubrics,items.reviews,items.contacts,items.external_content,items.description,items.point",
    }

    try:
        response = requests.get(url, params=params, timeout=10)
        if response.status_code == 200:
            return response.json()
        else:
            print(f"–û—à–∏–±–∫–∞ API: {response.status_code} –¥–ª—è {category}")
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: {e} –¥–ª—è {category}")

    return None


def is_in_kitai_gorod(place):
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –º–µ—Å—Ç–æ –≤ –ö–∏—Ç–∞–π-–≥–æ—Ä–æ–¥–µ"""
    kitai_gorod_bounds = {
        "sw_lat": 55.7470,
        "sw_lon": 37.6100,  # –†–∞—Å—à–∏—Ä–∏–ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã
        "ne_lat": 55.7650,
        "ne_lon": 37.6500,
    }

    if "point" in place:
        lat = place["point"].get("lat", 0)
        lon = place["point"].get("lon", 0)

        return (
            kitai_gorod_bounds["sw_lat"] <= lat <= kitai_gorod_bounds["ne_lat"]
            and kitai_gorod_bounds["sw_lon"] <= lon <= kitai_gorod_bounds["ne_lon"]
        )

    return False


def mass_search_kitai_gorod():
    """–ú–∞—Å—Å–æ–≤—ã–π –ø–æ–∏—Å–∫ –º–µ—Å—Ç –≤ –ö–∏—Ç–∞–π-–≥–æ—Ä–æ–¥–µ"""

    # –û–°–ù–û–í–ù–´–ï –ö–ê–¢–ï–ì–û–†–ò–ò –î–õ–Ø –ü–û–ò–°–ö–ê
    primary_categories = [
        "—Ä–µ—Å—Ç–æ—Ä–∞–Ω",
        "–∫–∞—Ñ–µ",
        "–±–∞—Ä",
        "–∫–æ—Ñ–µ–π–Ω—è",
        "–ø–∞–±",
        "—Å—Ç–æ–ª–æ–≤–∞—è",
        "–±–∏—Å—Ç—Ä–æ",
        "–ø–∏—Ü—Ü–µ—Ä–∏—è",
        "—Å—É—à–∏",
        "–±—É—Ä–≥–µ—Ä–Ω–∞—è",
        "—à–∞—à–ª—ã—á–Ω–∞—è",
        "–±–ª–∏–Ω–Ω–∞—è",
        "–ø–µ–ª—å–º–µ–Ω–Ω–∞—è",
        "–ø–µ–∫–∞—Ä–Ω—è",
        "–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∞—è",
        "–º–æ—Ä–æ–∂–µ–Ω–æ–µ",
        "—à–æ–∫–æ–ª–∞–¥",
        "–±—É–ª–æ—á–Ω–∞—è",
        "—á–∞–π–Ω–∞—è",
        "–≥—Ä–∏–ª—å-–±–∞—Ä",
        "–≤–∏–Ω–Ω—ã–π –±–∞—Ä",
        "–ø–∏–≤–Ω–æ–π –±–∞—Ä",
        "–ª–∞—É–Ω–∂-–±–∞—Ä",
    ]

    # –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ö–ê–¢–ï–ì–û–†–ò–ò
    secondary_categories = [
        "–º—É–∑–µ–π",
        "–≥–∞–ª–µ—Ä–µ—è",
        "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä",
        "—Ç–µ–∞—Ç—Ä",
        "–∫–ª—É–±",
        "–Ω–æ—á–Ω–æ–π –∫–ª—É–±",
        "–∫–∞—Ä–∞–æ–∫–µ",
        "–±–∏–ª—å—è—Ä–¥",
        "–±–æ—É–ª–∏–Ω–≥",
        "–∞–Ω—Ç–∏–∫–∞—Ñ–µ",
        "–ø–∞—Ä–∫",
        "—Å–∫–≤–µ—Ä",
        "—Å–∞–¥",
        "–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è",
        "–ø–ª–æ—â–∞–¥—å",
        "—Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞",
        "–±—É—Ç–∏–∫",
        "–º–∞–≥–∞–∑–∏–Ω",
        "—Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä",
        "—Å—É–≤–µ–Ω–∏—Ä—ã",
        "–∫–Ω–∏–∂–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω",
        "–æ—Ç–µ–ª—å",
        "–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞",
        "—Ö–æ—Å—Ç–µ–ª",
        "—Å–∞—É–Ω–∞",
        "—Å–ø–∞",
        "–±–∞–Ω—è",
        "—Ñ–∏—Ç–Ω–µ—Å",
        "–π–æ–≥–∞",
        "—Ö—Ä–∞–º",
        "—Å–æ–±–æ—Ä",
        "—Ü–µ—Ä–∫–æ–≤—å",
        "–ø–∞–º—è—Ç–Ω–∏–∫",
        "—Ñ–æ–Ω—Ç–∞–Ω",
    ]

    # –£–õ–ò–¶–´ –ö–ò–¢–ê–ô-–ì–û–†–û–î–ê
    kitai_gorod_streets = [
        "–í–∞—Ä–≤–∞—Ä–∫–∞",
        "–ò–ª—å–∏–Ω–∫–∞",
        "–ù–∏–∫–æ–ª—å—Å–∫–∞—è",
        "–ú–∞—Ä–æ—Å–µ–π–∫–∞",
        "–ü–æ–∫—Ä–æ–≤–∫–∞",
        "–ú—è—Å–Ω–∏—Ü–∫–∞—è",
        "–õ—É–±—è–Ω–∫–∞",
        "–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω–∫–∞",
        "–ö—É–∑–Ω–µ—Ü–∫–∏–π –ú–æ—Å—Ç",
        "–ü–µ—Ç—Ä–æ–≤–∫–∞",
        "–ù–µ–≥–ª–∏–Ω–Ω–∞—è",
        "–¢–≤–µ—Ä—Å–∫–∞—è",
        "–û—Ö–æ—Ç–Ω—ã–π –†—è–¥",
        "–ú–æ—Ö–æ–≤–∞—è",
        "–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∑–¥",
        "–ö–∏—Ç–∞–π–≥–æ—Ä–æ–¥—Å–∫–∏–π –ø—Ä–æ–µ–∑–¥",
        "–°—Ç–∞—Ä–∞—è –ø–ª–æ—â–∞–¥—å",
        "–ù–æ–≤–∞—è –ø–ª–æ—â–∞–¥—å",
    ]

    all_converted_places = []
    processed_titles = set()

    print("üöÄ –ó–ê–ü–£–°–ö –ú–ê–°–°–û–í–û–ì–û –ü–û–ò–°–ö–ê –í –ö–ò–¢–ê–ô-–ì–û–†–û–î–ï")
    print("=" * 50)

    # –ü–û–ò–°–ö –ü–û –û–°–ù–û–í–ù–´–ú –ö–ê–¢–ï–ì–û–†–ò–Ø–ú (–º–Ω–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü)
    print("\nüìã –ü–û–ò–°–ö –ü–û –û–°–ù–û–í–ù–´–ú –ö–ê–¢–ï–ì–û–†–ò–Ø–ú...")
    for category in primary_categories:
        print(f"\nüîç –ò—â–µ–º: {category.upper()}")

        for page in range(1, 6):  # –ü–æ 5 —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            print(f"   –°—Ç—Ä–∞–Ω–∏—Ü–∞ {page}...", end=" ")

            data = search_2gis_aggressive(category, page_size=50, page=page)
            if data and "result" in data and "items" in data["result"]:
                places = data["result"]["items"]

                # –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ö–∏—Ç–∞–π-–≥–æ—Ä–æ–¥—É
                kitai_gorod_places = [p for p in places if is_in_kitai_gorod(p)]

                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º
                for place in kitai_gorod_places:
                    if place.get("name") not in processed_titles:
                        converted = enhanced_convert_2gis_to_target_format(place)
                        all_converted_places.append(converted)
                        processed_titles.add(place.get("name"))
                        print(f"‚úì", end="")

                print(f" | –ù–∞–π–¥–µ–Ω–æ: {len(kitai_gorod_places)}")

                # –ï—Å–ª–∏ –º–µ–Ω—å—à–µ 10 –º–µ—Å—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                if len(places) < 10:
                    break
            else:
                print("‚úó –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")
                break

            time.sleep(0.2)  # –ö–æ—Ä–æ—Ç–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

    # –ü–û–ò–°–ö –ü–û –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ú –ö–ê–¢–ï–ì–û–†–ò–Ø–ú
    print("\nüìã –ü–û–ò–°–ö –ü–û –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ú –ö–ê–¢–ï–ì–û–†–ò–Ø–ú...")
    for category in secondary_categories:
        print(f"üîç –ò—â–µ–º: {category}...", end=" ")

        data = search_2gis_aggressive(category, page_size=30, page=1)
        if data and "result" in data and "items" in data["result"]:
            places = data["result"]["items"]
            kitai_gorod_places = [p for p in places if is_in_kitai_gorod(p)]

            for place in kitai_gorod_places:
                if place.get("name") not in processed_titles:
                    converted = enhanced_convert_2gis_to_target_format(place)
                    all_converted_places.append(converted)
                    processed_titles.add(place.get("name"))

            print(f"‚úì –ù–∞–π–¥–µ–Ω–æ: {len(kitai_gorod_places)}")
        else:
            print("‚úó –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")

        time.sleep(0.2)

    # –ü–û–ò–°–ö –ü–û –£–õ–ò–¶–ê–ú
    print("\nüìã –ü–û–ò–°–ö –ü–û –£–õ–ò–¶–ê–ú –ö–ò–¢–ê–ô-–ì–û–†–û–î–ê...")
    for street in kitai_gorod_streets:
        print(f"üìç –ò—â–µ–º –Ω–∞: {street}...", end=" ")

        data = search_2gis_aggressive(street, page_size=40, page=1)
        if data and "result" in data and "items" in data["result"]:
            places = data["result"]["items"]

            for place in places:
                if place.get("name") not in processed_titles and is_in_kitai_gorod(
                    place
                ):
                    converted = enhanced_convert_2gis_to_target_format(place)
                    all_converted_places.append(converted)
                    processed_titles.add(place.get("name"))

            print(f"‚úì –ù–∞–π–¥–µ–Ω–æ: {len([p for p in places if is_in_kitai_gorod(p)])}")
        else:
            print("‚úó –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")

        time.sleep(0.2)

    # –ü–û–ò–°–ö –ü–û –ö–õ–Æ–ß–ï–í–´–ú –°–õ–û–í–ê–ú
    print("\nüìã –ü–û–ò–°–ö –ü–û –ö–õ–Æ–ß–ï–í–´–ú –°–õ–û–í–ê–ú...")
    keywords = [
        "–∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è",
        "—è–ø–æ–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è",
        "–µ–≤—Ä–æ–ø–µ–π—Å–∫–∞—è –∫—É—Ö–Ω—è",
        "—Ä—É—Å—Å–∫–∞—è –∫—É—Ö–Ω—è",
        "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è –∫—É—Ö–Ω—è",
        "–∫–æ—Ñ–µ —Å —Å–æ–±–æ–π",
        "–∑–∞–≤—Ç—Ä–∞–∫",
        "–±–∏–∑–Ω–µ—Å-–ª–∞–Ω—á",
        "—É–∂–∏–Ω",
        "–∫—Ä–∞—Ñ—Ç–æ–≤–æ–µ –ø–∏–≤–æ",
        "–∫–æ–∫—Ç–µ–π–ª–∏",
        "–∂–∏–≤–∞—è –º—É–∑—ã–∫–∞",
        "–≤–µ—Ä–∞–Ω–¥–∞",
        "—Ç–µ—Ä—Ä–∞—Å–∞",
        "–ø–∞–Ω–æ—Ä–∞–º–Ω—ã–π –≤–∏–¥",
        "–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π",
        "—Å—Ç–∞—Ä–∏–Ω–Ω—ã–π",
        "–∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π",
    ]

    for keyword in keywords:
        print(f"üîë –ò—â–µ–º: '{keyword}'...", end=" ")

        data = search_2gis_aggressive(keyword, page_size=20, page=1)
        if data and "result" in data and "items" in data["result"]:
            places = data["result"]["items"]
            kitai_gorod_places = [p for p in places if is_in_kitai_gorod(p)]

            for place in kitai_gorod_places:
                if place.get("name") not in processed_titles:
                    converted = enhanced_convert_2gis_to_target_format(place)
                    all_converted_places.append(converted)
                    processed_titles.add(place.get("name"))

            print(f"‚úì –ù–∞–π–¥–µ–Ω–æ: {len(kitai_gorod_places)}")
        else:
            print("‚úó –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")

        time.sleep(0.2)

    # –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢
    print("\n" + "=" * 50)
    print(f"üéâ –ü–û–ò–°–ö –ó–ê–í–ï–†–®–ï–ù!")
    print(f"üìä –í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç: {len(all_converted_places)}")

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º
    type_stats = {}
    for place in all_converted_places:
        for entity_type in place["entity_types"]:
            type_stats[entity_type] = type_stats.get(entity_type, 0) + 1

    print("\nüìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –¢–ò–ü–ê–ú:")
    for entity_type, count in sorted(
        type_stats.items(), key=lambda x: x[1], reverse=True
    ):
        print(f"   {entity_type}: {count} –º–µ—Å—Ç")

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"kitai_gorod_massive_{timestamp}.json"

    with open(filename, "w", encoding="utf-8") as f:
        json.dump(all_converted_places, f, ensure_ascii=False, indent=2)

    # –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ—Å–Ω–æ–≤–Ω—É—é –±–∞–∑—É
    try:
        with open("places_data.json", "r", encoding="utf-8") as f:
            existing_data = json.load(f)
    except:
        existing_data = []

    # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏
    existing_titles = {p["title"] for p in existing_data}
    new_places = [p for p in all_converted_places if p["title"] not in existing_titles]

    existing_data.extend(new_places)

    with open("places_data.json", "w", encoding="utf-8") as f:
        json.dump(existing_data, f, ensure_ascii=False, indent=2)

    print(f"\nüíæ –î–ê–ù–ù–´–ï –°–û–•–†–ê–ù–ï–ù–´:")
    print(f"   –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª: places_data.json (–≤—Å–µ–≥–æ {len(existing_data)} –º–µ—Å—Ç)")
    print(f"   –û—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª: {filename}")
    print(f"   –ù–æ–≤—ã—Ö –º–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ: {len(new_places)}")

    return all_converted_places


# –ó–ê–ü–£–°–ö
if __name__ == "__main__":
    start_time = time.time()

    try:
        results = mass_search_kitai_gorod()

        end_time = time.time()
        duration = end_time - start_time

        print(f"\n‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {duration:.1f} —Å–µ–∫—É–Ω–¥")
        print(f"üì¶ –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å: {len(results) / duration:.1f} –º–µ—Å—Ç/—Å–µ–∫—É–Ω–¥—É")

    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback

        traceback.print_exc()
